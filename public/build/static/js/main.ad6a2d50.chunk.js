(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{122:function(e,t,a){e.exports=a(246)},127:function(e,t,a){},222:function(e,t){},225:function(e,t,a){},228:function(e,t,a){},246:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),o=a(21),i=a.n(o),r=(a(127),a(13)),l=a(14),c=a(16),h=a(15),m=a(17),d=a(248),u=a(249),p=a(260),g=a(250),f=a(251),v=a(261),y=a(252),E=a(247),w=a(264),b=a(18),k=a.n(b),x="https://squares64.herokuapp.com/",O={login:x+"user/login",islogin:x+"user/islogin",logout:x+"user/logout",skip:x+"pool/skip",signup:x+"user/signup",searchGame:x+"pool/search",joinMatch:x+"pool/match/join",updateMatch:x+"pool/match/update",matchList:x+"pool/match/list",matchWatch:x+"pool/match/watch",makeForfeit:x+"pool/match/forfeit",getMatchHis:x+"user/matchhistory"},S={socket:null},M=a(22);function j(e,t){return{type:"SHOW_ALERT",alert:{display:"block",type:t||"danger",content:e}}}function C(){return{type:"HIDE_ALERT",alert:{display:"none",content:""}}}function P(e){return{type:"SHOW_MODEL",content:{show:!0,content:e}}}function N(e){return{type:"HIDE_MODEL",content:{show:!1,content:""}}}var A=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(h.a)(t).call(this,e))).changeCount=function(){setInterval(function(){a.setState({countSec:a.state.countSec-1})},1e3)},a.logout=function(e){e.preventDefault();var t=sessionStorage.getItem("x-token");k()({method:"POST",url:O.logout,headers:{"x-token":t}}).then(function(e){a.props.handleLogin(!1),a.props.showAlert(e.data.message,"success"),setTimeout(function(){a.props.hideAlert()},3e3),sessionStorage.clear(),S.socket.disconnect(),S.socket=null}).catch(function(e){void 0!==e.data?a.props.showAlert(e.data.message):a.props.showAlert("error found"),setTimeout(function(){a.props.hideAlert()},3e3)})},a.handleChange=function(e){"email"===e.target.getAttribute("type")?a.setState({email:e.target.value}):a.setState({password:e.target.value})},a.login=function(e){e.preventDefault(),k.a.post(O.login,{email:a.state.email,password:a.state.password}).then(function(e){!0===e.data.status?(sessionStorage.setItem("x-token",e.headers["x-token"]),a.props.handleLogin(!0),a.setState({email:"",password:""}),a.props.showAlert(e.data.message,"success"),a.props.handleUserDetail(e.data.data)):a.props.showAlert(e.data.message),setTimeout(function(){a.props.hideAlert()},3e3)}).catch(function(e){a.props.showAlert("error found"),setTimeout(function(){a.props.hideAlert()},3e3)})},a.state={countSec:120,email:"",password:""},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props.login?s.a.createElement(s.a.Fragment,null,s.a.createElement("ul",{className:"nav navbar-nav"},s.a.createElement("li",{role:"presentation"},s.a.createElement(E.a,{role:"button",to:"/watch"},"Watch"))),s.a.createElement(d.a,{pullRight:!0},s.a.createElement(u.a,{eventKey:1,href:"#"},"Profile"),s.a.createElement(u.a,{eventKey:2,onClick:this.logout,href:"#"},"Logout"))):s.a.createElement(s.a.Fragment,null,s.a.createElement(p.a.Form,{pullRight:!0},s.a.createElement(g.a,{onSubmit:this.login},s.a.createElement(f.a,null,s.a.createElement(v.a,{type:"email",onChange:this.handleChange,value:this.state.email,placeholder:"Email"}),s.a.createElement(v.a,{type:"password",onChange:this.handleChange,value:this.state.password,placeholder:"Password"}))," ",s.a.createElement(y.a,{className:"btn-danger",type:"submit"},"Login"))));return s.a.createElement(p.a,{collapseOnSelect:!0},s.a.createElement(p.a.Header,null,s.a.createElement(p.a.Brand,null,s.a.createElement(E.a,{to:"/"},"64squares")),s.a.createElement(p.a.Toggle,null)),s.a.createElement(p.a.Collapse,null,e))}}]),t}(s.a.Component),T=Object(w.a)(Object(M.b)(null,{showAlert:j,hideAlert:C,showModel:P,hideModel:N})(A)),G=function(e){return s.a.createElement("header",null,s.a.createElement(T,{joinMatch:e.joinMatch,gameState:e.gameState,handleLogin:e.handleLogin,closeModel:e.closeModel,login:e.login,handleUserDetail:e.handleUserDetail}))},I=a(263),B=a(256),D=a(180),L=a(253),W=a(254),H=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(h.a)(t).call(this,e))).handleChange=function(e){"text"===e.target.getAttribute("type")?a.setState({name:e.target.value}):"email"===e.target.getAttribute("type")?a.setState({email:e.target.value}):"password"===e.target.getAttribute("type")&&("Password"===e.target.getAttribute("placeholder")?a.setState({password:e.target.value}):a.setState({conpassword:e.target.value}))},a.signup=function(e){e.preventDefault(),k.a.post(O.signup,{name:a.state.name,email:a.state.email,password:a.state.password,conpassword:a.state.conpassword}).then(function(e){a.setState({name:"",email:"",password:"",conpassword:""}),a.props.showAlert(e.data.message,"success"),setTimeout(function(){a.props.hideAlert()},3e3)}).catch(function(e){a.props.showAlert(e.response.data.message),setTimeout(function(){a.props.hideAlert()},3e3)})},a.state={name:"",email:"",password:"",conpassword:""},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement(D.a,null,s.a.createElement(L.a,{className:"show-grid"},s.a.createElement(W.a,{xs:12,md:9},s.a.createElement("div",null,s.a.createElement("h2",null,"Welcome"),s.a.createElement("p",null,"Lorem ipsum dolor sit amet consectetur adipisicing elit. Similique unde hic vitae debitis repellendus neque eaque dolor quo natus quae esse soluta minus iusto, amet voluptates, iure alias repudiandae itaque!"),s.a.createElement("p",null,"Lorem ipsum dolor sit amet consectetur adipisicing elit. Similique unde hic vitae debitis repellendus neque eaque dolor quo natus quae esse soluta minus iusto, amet voluptates, iure alias repudiandae itaque!"))),s.a.createElement(W.a,{style:{paddingRight:"30px"},xs:6,md:3},s.a.createElement("h2",null,"Sign Up"),s.a.createElement("div",null,s.a.createElement(g.a,{horizontal:!0,onSubmit:this.signup},s.a.createElement(f.a,{controlId:"formHorizontalName"},s.a.createElement(W.a,{sm:12},s.a.createElement(v.a,{value:this.state.name,onChange:this.handleChange,type:"text",placeholder:"Name"}))),s.a.createElement(f.a,{controlId:"formHorizontalEmail"},s.a.createElement(W.a,{sm:12},s.a.createElement(v.a,{value:this.state.email,onChange:this.handleChange,type:"email",placeholder:"Email"}))),s.a.createElement(f.a,{controlId:"formHorizontalPassword"},s.a.createElement(W.a,{sm:12},s.a.createElement(v.a,{value:this.state.password,onChange:this.handleChange,type:"password",placeholder:"Password"}))),s.a.createElement(f.a,{controlId:"formHorizontalConPassword"},s.a.createElement(W.a,{sm:12},s.a.createElement(v.a,{value:this.state.conpassword,onChange:this.handleChange,type:"password",placeholder:"Conform Password"}))),s.a.createElement(f.a,null,s.a.createElement(W.a,{smOffset:0,sm:10},s.a.createElement(y.a,{className:"btn-danger ml-3",style:{marginRight:"12px"},type:"submit"},"Sign Up"),s.a.createElement(y.a,{type:"reset"},"Reset"))))))))}}]),t}(s.a.Component),R=Object(M.b)(null,{showAlert:j,hideAlert:C,showModel:P,hideModel:N})(H),F=a(28),q=a(41),_=a.n(q),Y=function e(t){var a=this;if(Object(r.a)(this,e),this.checkMate=function(){for(var e="black"===this.type?"b":"w",t="black"===this.type?"w":"b",a=Object.keys(this.assignPieces),n=1;n<a.length;n++)if(this.assignPieces[a[n]].type===e&&"king"===this.assignPieces[a[n]].pieces){for(var s=parseInt(a[n].substring(1)),o=this.moves.cross(s),i=0;i<o.length;i++)for(var r=0;r<o[i].length;r++)if(void 0!==this.assignPieces["p"+o[i][r]]){if(this.assignPieces["p"+o[i][r]].type===t&&("queen"===this.assignPieces["p"+o[i][r]].pieces||"bishop"===this.assignPieces["p"+o[i][r]].pieces||0===r&&"pawn"===this.assignPieces["p"+o[i][r]].pieces||0===r&&"king"===this.assignPieces["p"+o[i][r]].pieces))return!0;break}for(var l=this.moves.straight(s),c=0;c<l.length;c++)for(var h=0;h<l[c].length;h++)if(void 0!==this.assignPieces["p"+l[c][h]]){if(this.assignPieces["p"+l[c][h]].type===t&&("queen"===this.assignPieces["p"+l[c][h]].pieces||"rook"===this.assignPieces["p"+l[c][h]].pieces||0===h&&"king"===this.assignPieces["p"+l[c][h]].pieces))return!0;break}for(var m=this.moves.lshape(s),d=0;d<m.length;d++)for(var u=0;u<m[d].length;u++)if(void 0!==this.assignPieces["p"+m[d][u]]&&this.assignPieces["p"+m[d][u]].type===t&&"knight"===this.assignPieces["p"+m[d][u]].pieces)return!0}},this.start=function(e){this.cb=e,"player"===this.userTYpe&&this.startPiecesPosition(),this.createBox(e),this.renderPeices(),"player"===this.userTYpe&&this.createDetailBox()},this.changeMoveStatus=function(e){this.moveQue=e},this.startPiecesPosition=function(){for(var e={white:["rook","knight","bishop","queen","king","bishop","knight","rook"],black:["rook","knight","bishop","king","queen","bishop","knight","rook"]}[this.type],t=17,a=1,n="black"===this.type?["w","b"]:["b","w"],s=1;s<=t;s++)this.assignPieces["p"+s]=s<=8||s>56&&s<65?{pieces:e[s-a],type:s<=8?n[0]:n[1],img:e[s-a]+(s<=8?n[0]:n[1])}:{pieces:"pawn",type:s<17?n[0]:n[1],img:"pawn"+(s<17?n[0]:n[1])},16===s&&(s=48,t=64,a=57)},this.getCoordinate=function(e){for(var t=1;t<9;t++)if(e<8*t+1)return[e-8*(t-1),t]},this.verifyMove=function(e,t,a){for(var n=this.assignPieces[e],s=parseInt(e.substring(1)),o=parseInt(t.substring(1)),i=this.pieces[n.pieces],r=[],l=0;l<i.length;l++){var c=[];if("pawn"===n.pieces){if((c=this.moves[i[l]](s))[0].includes(o)&&"remove"===a)return!1;if(!c[0].includes(o)&&"remove"===a&&(c=this.moves.pawncross(s))[0].includes(o))return!0}else if(c=this.moves[i[l]](s),"king"===n.pieces)for(var h=0;h<c.length;h++)c[h]=[c[h][0]];c.length>0&&(r=r.concat(c))}for(var m=null,d=0;d<r.length;d++)r[d].includes(o)&&(m=d);if(null===m)return!1;if("knight"!==n.pieces){var u=0,p=r[m].indexOf(o);if(p>0)for(;"new"===a?u<=p:u<p;){if(this.assignPieces["p"+r[m][u]])return!1;u++}}return!0},this.moves={boundry:[1,2,3,4,5,6,7,8,16,24,32,40,48,56,64,63,62,61,60,59,58,57,49,41,33,25,17,9],corner:[57,8,64,1],leftBoundry:[49,41,33,25,17,9],rightBoundry:[16,24,32,40,48,56],topBoundry:[2,3,4,5,6,7],bottomBoundry:[63,62,61,60,59,58],cross:function(e){var t=[],a=[-7,7,-9,9],n=[];this.leftBoundry.includes(e)?n=[-7,9]:this.rightBoundry.includes(e)?n=[7,-9]:this.topBoundry.includes(e)?n=[7,9]:this.bottomBoundry.includes(e)?n=[-7,-9]:this.corner.includes(e)&&(n=[a[this.corner.indexOf(e)]]);for(var s=0;s<a.length;s++){var o=e,i=[];if(this.boundry.includes(e)){if(n.includes(a[s]))do{o+=a[s],i.push(o)}while(!this.boundry.includes(o))}else for(;!this.boundry.includes(o);)o+=a[s],i.push(o);i.length>0&&t.push(i)}return t},straight:function(e){var t=[],a=[-1,1,-8,8],n=[],s=[];1===e?(n=[1,8],s=[8,57]):8===e?(n=[8,-1],s=[1,64]):64===e?(n=[-1,-8],s=[8,57]):57===e?(n=[1,-8],s=[1,64]):this.leftBoundry.includes(e)?(n=[8,-8,1],s=[1,57,e+7]):this.rightBoundry.includes(e)?(n=[8,-8,-1],s=[8,64,e-7]):this.topBoundry.includes(e)?(n=[1,-1,8],s=[1,8,e+56]):this.bottomBoundry.includes(e)&&(n=[1,-1,-8],s=[57,64,e-56]);for(var o=0;o<a.length;o++){var i=e,r=[];if(this.boundry.includes(e)){if(n.includes(a[o]))do{i+=a[o],r.push(i)}while(!s.includes(i))}else do{i+=a[o],r.push(i)}while(!this.boundry.includes(i));r.length>0&&t.push(r)}return t},lshape:function(e){for(var t=[[1,16],[1,-16],[-1,16],[-1,-16],[8,2],[8,-2],[-8,2],[-8,-2]],n=[],s=a.getCoordinate(e),o=0;o<t.length;o++){var i=e+t[o][0]+t[o][1];if(i>0&&i<65&&e+t[o][0]>0){var r=a.getCoordinate(i);Math.abs(s[0]-r[0])<3&&Math.abs(s[1]-r[1])<3&&n.push(i)}}return[n]},forward:function(e){return[49,50,51,52,53,54,55,56].includes(e)?[[e-8,e-16]]:[[e-8]]},pawncross:function(e){var t=[],a=[];a=this.leftBoundry.includes(e)?[[1,-8]]:this.rightBoundry.includes(e)?[[-1,-8]]:[[-1,-8],[1,-8]];for(var n=0;n<a.length;n++)t.push(e+a[n][0]+a[n][1]);return[t]}},this.handleEvent=function(e,t){if(e.stopPropagation(),!0===a.moveQue){var n=e.target;if(""===n.className){var s=n.parentNode,o=a.assignPieces[s.className];if(a.type.charAt(0)===o.type)null!==a.startMove&&(document.getElementsByClassName(a.startMove)[0].style.backgroundColor=a.prevBack),a.startMove=s.className,a.prevBack=s.style.backgroundColor,s.style.backgroundColor="#9ec157";else if(null!==a.startMove&&a.verifyMove(a.startMove,s.className,"remove")){var i=a.assignPieces[s.className];if(n.remove(),s.appendChild(document.getElementsByClassName(a.startMove)[0].childNodes[0]),a.removedPieces[a.assignPieces[s.className].type].push(a.assignPieces[s.className]),a.assignPieces[s.className]=a.assignPieces[a.startMove],delete a.assignPieces[a.startMove],document.getElementsByClassName(a.startMove)[0].style.backgroundColor=a.prevBack,a.prevBack=null,a.checkMate())t("checkmate");else{var r={start:{move:a.startMove,content:a.assignPieces[s.className]},end:{move:s.className},removed:{content:i}};t(r),"player"===a.userTYpe&&a.renderDetails(r)}a.startMove=null}}else null!==a.startMove&&a.verifyMove(a.startMove,n.className,"new")&&(n.appendChild(document.getElementsByClassName(a.startMove)[0].childNodes[0]),document.getElementsByClassName(a.startMove)[0].style.backgroundColor=a.prevBack,Object.defineProperty(a.assignPieces,n.className,Object.getOwnPropertyDescriptor(a.assignPieces,a.startMove)),delete a.assignPieces[a.startMove],a.prevBack=null,a.checkMate()?t("checkmate"):t({start:{move:a.startMove,content:a.assignPieces[n.className]},end:{move:n.className},removed:{}}),a.startMove=null)}},this.renderPeices=function(){for(var e=Object.keys(this.assignPieces),t=0;t<e.length;t++){var a=document.createElement("img");a.src="/images/chess/".concat(this.assignPieces[e[t]].img,".png"),a.style.cssText="width:100%;height:100%;padding:12%;",document.getElementsByClassName(e[t])[0].appendChild(a)}},this.renderDetails=function(e){for(var t=document.getElementsByClassName("w"===e.removed.content.type?"piecesFieldb":"piecesFieldw")[0].children,a=0;a<t.length;a++)if("p"===t[a].children[0].nodeName.toLowerCase()){t[a].children[0].remove();var n=document.createElement("img");return n.src="/images/chess/".concat(e.removed.content.img,".png"),n.style.cssText="width:100%; height:100%;",void t[a].append(n)}},this.handleEventMove=function(e){a.handleEvent(e,a.cb)},this.createBox=function(e){for(var t=.12*this.element.clientWidth,a=[this.blackColor,this.whiteColor],n=1;n<=64;n++){var s=document.createElement("div");"player"===this.userTYpe&&s.addEventListener("click",this.handleEventMove),s.className="p"+n,s.style.cssText="height:".concat(t,"px;width:").concat(t,"px;border:1px solid black;background-color:").concat(a[n%2]),this.element.appendChild(s),n%8===0&&a.reverse(),s=null}},this.createDetailBox=function(){this.playerElement.style.cssText=" max-width: 280px;min-height: 220px;padding:25px 10px;";for(var e=0;e<2;e++){var t=document.createElement("div");t.style.cssText="width:100%;";var a=document.createElement("div"),n=document.createElement("h5");n.style.cssText="text-align: center;";var s=document.createElement("div");if(1===e){var o="black"===this.type?this.playerObj.black.img:this.playerObj.white.img;n.textContent="Player : ".concat("black"===this.type?this.playerObj.black.name:this.playerObj.white.name),a.style.cssText="background-image:url(/images/chess/".concat(o,");background-repeat:no-repeat;background-size:100% 100%;width:100px;height: 100px; border:1px solid #d1d1d1;margin:0 auto;"),s.style.cssText="width:100%; height: auto;display: flex;flex-flow: row;flex-wrap: wrap-reverse;justify-content: space-between;"}else{var i="black"===this.type?this.playerObj.white.img:this.playerObj.black.img;s.style.cssText="width:100%; height: auto;display: flex;flex-flow: row;flex-wrap: wrap;justify-content: space-between;",n.textContent="Player : ".concat("black"===this.type?this.playerObj.white.name:this.playerObj.black.name),a.style.cssText="background-image:url(/images/chess/".concat(i,");background-repeat:no-repeat;background-size:100% 100%;width:100px;height: 100px; border:1px solid #d1d1d1;margin:0 auto;")}for(var r=1;r<=16;r++){var l=document.createElement("div");l.style.cssText="width:41px; height:41px;border:1px solid black;margin-bottom:2px; text-align:center",l.innerHTML="<p>"+r+"</p>",s.append(l)}if(0===e?(t.append(a),t.append(n),t.append(s),s.className="black"===this.type?"piecesFieldw":"piecesFieldb",a.className="black"===this.type?"imgw":"imgb"):(t.append(s),t.append(n),t.append(a),s.className="black"===this.type?"piecesFieldb":"piecesFieldw",a.className="black"===this.type?"imgb":"imgw"),this.playerElement.append(t),0===e){var c=document.createElement("div");c.style.cssText="border:2px solid #d1d1d1;width:60%;margin:25px auto;",this.playerElement.append(c)}}},this.renderOpponentMove=function(e){if(e.start.content.type!=={white:"w",black:"b"}[this.type]){var t=65-parseInt(e.start.move.substring(1));t="p"+t;var a=document.getElementsByClassName(t),n=65-parseInt(e.end.move.substring(1));n="p"+n;var s=document.getElementsByClassName(n);s[0].childNodes.length>0&&(s[0].childNodes[0].remove(),this.renderDetails({removed:{content:this.assignPieces[n]}}));var o=this.assignPieces[t];this.assignPieces[n]=o,delete this.assignPieces[t],s[0].appendChild(a[0].childNodes[0])}},this.renderMove=function(e){var t={white:"w",black:"b"},a=e.start.content.type!==t[this.type]?65-parseInt(e.start.move.substring(1)):parseInt(e.start.move.substring(1));a="p"+a;var n=document.getElementsByClassName(a),s=e.start.content.type!==t[this.type]?65-parseInt(e.end.move.substring(1)):parseInt(e.end.move.substring(1));s="p"+s;var o=document.getElementsByClassName(s);o[0].childNodes.length>0&&o[0].childNodes[0].remove();var i=this.assignPieces[a];this.assignPieces[s]=i,delete this.assignPieces[a],o[0].appendChild(n[0].childNodes[0])},this.destory=function(){if("player"===this.userTYpe){for(var e=0;e<64;e++)this.element.children[e].removeEventListener("click",this.handleEventMove);this.element.innerHTML="",this.element.detailId=""}else this.element.innerHTML=""},void 0===t.id||""===t.id.replace(/\s/g,""))throw new Error("There is no element is selected");if(!["player","audience"].includes(t.userType))throw new Error("User type must be defined");if("player"===t.userType&&(void 0===t.detailId||""===t.detailId.replace(/\s/g,"")))throw new Error("There is no element is selected for player detail");if("audience"===t.userType&&(void 0===t.assignPieces||"object"!==typeof t.assignPieces))throw new Error("Audience must have moved peices steps");if(!["black","white"].includes(t.type))throw new Error("There is no element is selected");this.prevBack=null,this.blackColor="grey",this.whiteColor="white",this.moveQue="black"!==t.type,this.startMove=null,this.removedPieces={b:[],w:[]},this.pieces={pawn:["forward"],knight:["lshape"],bishop:["cross"],rook:["straight"],queen:["straight","cross"],king:["straight","cross"]},this.assignPieces="audience"===t.userType?t.assignPieces:{},this.type=t.type,this.element=document.getElementById(t.id),this.playerElement=document.getElementById(t.detailId),this.element.style.cssText="max-width:600px;max-height:650px; width:100%;display:flex;flex-direction: row;flex-wrap: wrap;",this.moveStatus=!1,this.playerObj=t.player,this.userTYpe=t.userType,this.cb=null},U=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(h.a)(t).call(this,e))).closeGame=function(){a.newGame.destory()},a.newGame=null,a.state={show:a.props.winInfo},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){this.newGame.destory()}},{key:"componentDidMount",value:function(){var e=sessionStorage.getItem("x-token"),t=this;this.newGame=new Y({id:"match",type:"white",userType:"audience",assignPieces:this.props.resp.data.gameState}),this.newGame.start(),S.socket.emit("join",this.props.resp.data.room,e,!1),S.socket.on("ongame",function(e){t.newGame.renderMove(e)})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement("div",{className:"text-right"},s.a.createElement(y.a,{onClick:function(){return e.props.handleGameWatch(!1)}},"CLose")),s.a.createElement("div",{id:"match"}))}}]),t}(s.a.Component),z=function(e){return s.a.createElement("div",null,"this is info")},J=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(h.a)(t).call(this,e))).handleWatchMatch=function(e){e.stopPropagation();var t=sessionStorage.getItem("x-token"),n=Object(F.a)(Object(F.a)(a));k()({method:"POST",url:O.matchWatch,headers:{"x-token":t},data:{room:e.target.closest(".wcg").dataset.gameid}}).then(function(e){n.setState({gameInfo:e}),n.props.handleGameWatch(!0)}).catch(function(e){})},a.closeGameWatch=function(e){a.setState({gameOn:e})},a.newGame=null,a.state={gameOn:!1,gameInfo:null},a.ingame=!1,a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;null==S.socket&&(S.socket=_()("http://localhost:3001"),S.socket.on("pool",function(t){if(t.room){e.ingame=!0;var a={title:"Your Game is Ready",body:s.a.createElement("div",null,s.a.createElement(y.a,{onClick:e.props.joinMatch},"Join"),s.a.createElement(y.a,{onClick:e.props.closeModel},"close"))};e.props.showModel(a),e.props.gameState(!1),e.props.setRoom(t)}else if(t.skip){a={title:"Your opponent skip the game",body:s.a.createElement("div",null,s.a.createElement(y.a,{onClick:e.props.hideGame},"Leave"))};e.props.gameState(!1),e.props.showModel(a)}else if(t.winner)if(t.winner.id.toString()===S.socket.id){a={title:"You won the game",body:s.a.createElement("div",null,s.a.createElement(y.a,{onClick:e.props.hideGame},"Leave Game"))};e.props.showModel(a)}else e.props.handleAudienceWinerAlert(!0,t.winner.type)}));var t=sessionStorage.getItem("x-token");k()({method:"POST",url:O.matchList,headers:{"x-token":t}}).then(function(t){for(var a=0;a<t.data.length;a++){var n=document.createElement("div");n.className="wcg",n.addEventListener("dblclick",e.handleWatchMatch),n.setAttribute("data-gameid",t.data[a].room);var s=document.createElement("div");s.className="wpi",s.style.cssText="background-image:url(/images/profile/".concat(t.data[a].bplayer.img,");background-repeat:no-repeat;background-size:100% 100%;");var o=document.createElement("div");o.className="wpi",o.style.cssText="background-image:url(/images/profile/".concat(t.data[a].wplayer.img,");background-repeat:no-repeat;background-size:100% 100%;");var i=document.createElement("p");i.textContent=t.data[a].bplayer.name;var r=document.createElement("p");r.textContent="VS";var l=document.createElement("p");l.textContent=t.data[a].wplayer.name;var c=document.createElement("div");c.className="wpn",c.appendChild(i),c.appendChild(r),c.appendChild(l),n.appendChild(s),n.appendChild(c),n.appendChild(o),document.getElementById("matchlist").appendChild(n)}}).catch(function(e){})}},{key:"render",value:function(){var e=this.props.gameWatch?s.a.createElement(U,{handleGameWatch:this.props.handleGameWatch,winInfo:this.props.winInfo,closeGameWatch:this.closeGameWatch,resp:this.state.gameInfo}):s.a.createElement(z,null);return s.a.createElement(D.a,null,s.a.createElement(L.a,{className:"show-grid"},s.a.createElement(W.a,{style:{paddingRight:"30px"},xs:6,md:3},s.a.createElement("div",{id:"matchlist"})),s.a.createElement(W.a,{xs:12,style:{borderLeft:"2px solid #d1d1d1",minHeight:"75vh"},md:9},e)))}}]),t}(s.a.Component),Q=Object(M.b)(null,{showAlert:j,hideAlert:C,showModel:P,hideModel:N})(J),V=a(259),X=(a(225),function(e){function t(){return Object(r.a)(this,t),Object(c.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement(V.a,{className:"pfp"},s.a.createElement(V.a.Heading,null,"MY PROFILE"),s.a.createElement(V.a.Body,null,s.a.createElement("div",{className:"text-center"},s.a.createElement("img",{className:"pimg",src:"/images/profile/questionmark.png",alt:"profile pic"}),s.a.createElement("div",{className:""},s.a.createElement("p",{className:"pname"},this.props.userdetail.name))),s.a.createElement("div",{className:"clearfix "},s.a.createElement(L.a,{className:"show-grid"},s.a.createElement(W.a,{className:"text-left",style:{marginLeft:"3%"}},s.a.createElement(V.a,{className:"nfm floatLeft"},s.a.createElement(V.a.Heading,null,"Games"),s.a.createElement(V.a.Body,null,this.props.userdetail.game))),s.a.createElement(W.a,{className:""},s.a.createElement(V.a,{className:"nfm floatRight",style:{marginRight:"3%"}},s.a.createElement(V.a.Heading,null,"Wins"),s.a.createElement(V.a.Body,null,this.props.userdetail.win)))))))}}]),t}(s.a.Component)),K=a(255),$=(a(228),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(h.a)(t).call(this,e))).state={data:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props.hist.map(function(e){return s.a.createElement("tr",null,s.a.createElement("td",null,e.start),s.a.createElement("td",null,e.player),s.a.createElement("td",null,e.win),s.a.createElement("td",null,e.duration),s.a.createElement("td",null,e.start))});return s.a.createElement("div",{className:"gamehis"},s.a.createElement(K.a,{responsive:!0},s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null,"Date Time"),s.a.createElement("th",null,"Player"),s.a.createElement("th",null,"Result"),s.a.createElement("th",null,"Duration"),s.a.createElement("th",null,"Start"))),s.a.createElement("tbody",{id:"listHist"},e)),";")}}]),t}(s.a.Component)),Z=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(h.a)(t).call(this,e))).state={data:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;null==S.socket&&(S.socket=_()("http://localhost:3001"),S.socket.on("pool",function(t){if(t.room){e.ingame=!0;var a={title:"Your Game is Ready",body:s.a.createElement("div",null,s.a.createElement(y.a,{onClick:e.props.joinMatch},"Join"),s.a.createElement(y.a,{onClick:e.props.closeModel},"close"))};e.props.showModel(a),e.props.gameState(!1),e.props.setRoom(t)}else if(t.skip){a={title:"Your opponent skip the game",body:s.a.createElement("div",null,s.a.createElement(y.a,{onClick:e.props.hideGame},"Leave"))};e.props.gameState(!1),e.props.showModel(a)}else if(t.winner)if(t.winner.id.toString()===S.socket.id){a={title:"You won the game",body:s.a.createElement("div",null,s.a.createElement(y.a,{onClick:e.props.hideGame},"Leave Game"))};e.props.showModel(a)}else t.winner.lid.toString()!==S.socket.id&&e.props.handleAudienceWinerAlert(!0,t.winner.type)}))}},{key:"render",value:function(){return s.a.createElement(D.a,null,s.a.createElement(L.a,{className:"show-grid"},s.a.createElement(W.a,{xs:6,md:3},s.a.createElement(X,{userdetail:this.props.userdetail})),s.a.createElement(W.a,{xs:12,md:9},s.a.createElement($,{hist:this.props.hist}))))}}]),t}(s.a.Component),ee=Object(M.b)(null,{showAlert:j,hideAlert:C,showModel:P,hideModel:N})(Z),te=function(e){function t(){return Object(r.a)(this,t),Object(c.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,"Page not found")}}]),t}(s.a.Component),ae=a(258),ne=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(h.a)(t).call(this,e))).leaveGame=function(){a.setState({checkMate:!1}),a.props.hideGame()},a.makeForfeit=function(){var e=Object(F.a)(Object(F.a)(a)),t=sessionStorage.getItem("x-token");k()({method:"POST",url:O.makeForfeit,headers:{"x-token":t},data:{room:a.props.gameData.room}}).then(function(t){e.props.hideGame()}).catch(function(e){})},a.state={show:!1,content:"",checkMate:!1},a.newGame=null,a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){this.newGame.destory()}},{key:"componentDidMount",value:function(){this.newGame=new Y({id:"game",detailId:"gameDetail",type:this.props.gameData.type,player:this.props.gameData.player,userType:this.props.gameData.userType}),S.socket.on("ongame",function(t){e.newGame.renderOpponentMove(t),e.newGame.changeMoveStatus(e.props.gameData.type===t.moveQue)});var e=this;this.newGame.start(function(t){if("checkmate"===t){e.setState({checkMate:!0});var a=sessionStorage.getItem("x-token");k()({method:"POST",url:O.makeForfeit,headers:{"x-token":a},data:{room:e.props.gameData.room}}).then(function(e){}).catch(function(e){})}else{var n=sessionStorage.getItem("x-token");k()({method:"PUT",url:O.updateMatch,headers:{"x-token":n},data:{room:e.props.gameData.room,move:t}}).then(function(e){}).catch(function(e){})}})}},{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement(ae.a,{show:this.props.forfeit},s.a.createElement(ae.a.Body,null,s.a.createElement("p",null,"Are you sure?"),s.a.createElement(y.a,{variant:"danger",onClick:this.makeForfeit},"Yes"),s.a.createElement(y.a,{onClick:this.props.hideForfeit,variant:"info"},"No"),this.state.content)),s.a.createElement(ae.a,{show:this.state.checkMate},s.a.createElement(ae.a.Body,null,s.a.createElement("p",null,"Checkmate You lose the game"),s.a.createElement(y.a,{variant:"danger",onClick:this.leaveGame},"Leave game"))),s.a.createElement(D.a,null,s.a.createElement(L.a,{className:"show-grid"},s.a.createElement(W.a,{xs:12,md:8},s.a.createElement("div",{id:"game"})),s.a.createElement(W.a,{xs:6,md:4},s.a.createElement("div",{id:"gameDetail"})))))}}]),t}(s.a.Component),se=a(257),oe=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(h.a)(t).call(this,e))).handleUserDetail=function(e){a.setState({userdetail:e})},a.setRoom=function(e){a.setState({room:e})},a.joinMatch=function(e){var t=sessionStorage.getItem("x-token");k()({method:"PATCH",url:O.joinMatch,headers:{"x-token":t},data:{room:a.state.room.room,type:a.state.room.type,socektid:S.socket.id}}).then(function(e){a.props.hideModel(),setTimeout(function(){a.setState({gameShow:!0})},200),S.socket.emit("join",a.state.room.room,t,!0),a.props.showAlert(e.data.message,"success"),setTimeout(function(){a.props.hideAlert()},3e3),a.setState({gameSearch:!1})}).catch(function(e){void 0!==e.data?a.props.showAlert(e.data.message):a.props.showAlert("error found"),setTimeout(function(){a.props.hideAlert()},3e3)})},a.closeModel=function(e){if(void 0!==e&&("button"===e.target.type||"button"===e.target.parentNode.type)){var t=sessionStorage.getItem("x-token");k()({method:"PATCH",url:O.skip,headers:{"x-token":t},data:{room:a.state.room.room}}).then(function(e){a.props.showAlert(e.data.message,"success"),setTimeout(function(){a.props.hideAlert()},3e3),a.setState({gameSearch:!0})}).catch(function(e){void 0!==e.data?a.props.showAlert(e.data.message):a.props.showAlert("error found"),setTimeout(function(){a.props.hideAlert()},3e3)}),a.props.hideModel()}},a.handleLogin=function(e){a.setState({login:e})},a.gameState=function(e){a.setState({gameSearch:e})},a.handleGameSearch=function(e){var t=sessionStorage.getItem("x-token");!1===a.state.gameSearch?k()({method:"POST",url:O.searchGame+"/start",headers:{"x-token":t},data:{socketid:S.socket.id}}).then(function(e){a.props.showAlert(e.data.message,"success"),setTimeout(function(){a.props.hideAlert()},3e3),a.setState({gameSearch:!0})}).catch(function(e){void 0!==e.data?a.props.showAlert(e.data.message):a.props.showAlert("error found"),setTimeout(function(){a.props.hideAlert()},3e3)}):k()({method:"POST",url:O.searchGame+"/end",headers:{"x-token":t}}).then(function(e){a.props.showAlert(e.data.message,"success"),setTimeout(function(){a.props.hideAlert()},3e3),a.setState({gameSearch:!1})}).catch(function(e){void 0!==e.data?a.props.showAlert(e.data.message):a.props.showAlert("error found"),setTimeout(function(){a.props.hideAlert()},3e3)})},a.handleForfeit=function(e){a.setState({forfeit:!0})},a.hideForfeit=function(e){a.setState({forfeit:!1})},a.hideGame=function(){a.setState({gameShow:!1,room:"",forfeit:!1}),a.props.hideModel(),a.loadHistory()},a.handleAudienceWinerAlert=function(e,t){a.props.showModel({title:"Player ".concat(t," won the game"),body:s.a.createElement("div",null,s.a.createElement(y.a,{onClick:function(e){return a.handleGameWatch(!1)}},"Leave Game"))})},a.handleGameWatch=function(e){a.setState({gameWatch:e}),a.props.hideModel()},a.state={login:!1,gameSearch:!1,room:"",gameShow:!1,forfeit:!1,gameWatch:!1,userdetail:{},hist:[]},a.timeIntervalVar=null,a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"renderHistory",value:function(){}},{key:"componentWillMount",value:function(){var e=sessionStorage.getItem("x-token");if(null!=e){var t=this;k()({method:"POST",url:O.islogin,headers:{"x-token":e}}).then(function(e){void 0===e.data.data?sessionStorage.clear():t.setState({login:!0,userdetail:e.data.data})}).catch(function(e){})}}},{key:"componentDidMount",value:function(){this.loadHistory()}},{key:"loadHistory",value:function(){var e=this,t=sessionStorage.getItem("x-token");k()({method:"GET",url:O.getMatchHis,headers:{"x-token":t}}).then(function(t){e.setState({hist:t.data})}).catch(function(e){})}},{key:"render",value:function(){var e=this,t=this.state.gameSearch?s.a.createElement(y.a,{onClick:this.handleGameSearch},"...Searching Game ",s.a.createElement("img",{src:"/images/chess/searching.gif",style:{height:"20px"}})):s.a.createElement(y.a,{onClick:this.handleGameSearch},"Search Game"),a=(this.state.login,this.state.login?t:""),n=this.state.login?s.a.createElement(I.a,null,s.a.createElement(B.a,{exact:!0,path:"/",render:function(t){return s.a.createElement(ee,Object.assign({},t,{hideGame:e.hideGame,userdetail:e.state.userdetail,joinMatch:e.joinMatch,gameState:e.gameState,setRoom:e.setRoom,room:e.state.room,hist:e.state.hist,handleAudienceWinerAlert:e.handleAudienceWinerAlert,closeModel:e.closeModel}))}}),s.a.createElement(B.a,{path:"/watch",render:function(t){return s.a.createElement(Q,Object.assign({},t,{hideGame:e.hideGame,setRoom:e.setRoom,joinMatch:e.joinMatch,gameState:e.gameState,room:e.state.room,gameWatch:e.state.gameWatch,handleAudienceWinerAlert:e.handleAudienceWinerAlert,handleGameWatch:e.handleGameWatch}))}}),s.a.createElement(B.a,{path:"/*",component:te})):s.a.createElement(I.a,null,s.a.createElement(B.a,{exact:!0,path:"/",component:R}),s.a.createElement(B.a,{path:"/*",component:te}));return s.a.createElement(s.a.Fragment,null,s.a.createElement(ae.a,{className:"gameModel",show:this.state.gameShow,dialogClassName:"custom-modal"},s.a.createElement(ae.a.Header,null,s.a.createElement(ae.a.Title,{id:"contained-modal-title-lg"},s.a.createElement(D.a,null,s.a.createElement(L.a,{className:"show-grid"},s.a.createElement(W.a,{xs:6,md:8},"Game ID - ",this.state.room.room),s.a.createElement(W.a,{xs:6,md:4,style:{textAlign:"right"}},s.a.createElement(y.a,{bsStyle:"danger",onClick:this.handleForfeit},"FORFEIT")))))),s.a.createElement(ae.a.Body,null,s.a.createElement(ne,{hideGame:this.hideGame,hideForfeit:this.hideForfeit,forfeit:this.state.forfeit,gameData:this.state.room}))),s.a.createElement(ae.a,{show:this.props.model.show,onHide:this.closeModel},s.a.createElement(ae.a.Header,{closeButton:!0},s.a.createElement(ae.a.Title,null,this.props.model.content.title)),s.a.createElement(ae.a.Body,null,this.props.model.content.body)),s.a.createElement(se.a,{bsStyle:this.props.alert.type,onDismiss:this.props.hideAlert,style:{display:this.props.alert.display,position:"absolute",right:"20px",top:"20px",zIndex:"100"}},this.props.alert.content),s.a.createElement(G,{handleLogin:this.handleLogin,login:this.state.login,handleUserDetail:this.handleUserDetail}),s.a.createElement("div",{className:"container text-right",style:{marginBottom:"25px"}},a),n)}}]),t}(n.Component),ie=Object(w.a)(Object(M.b)(function(e){return e},{showAlert:j,hideAlert:C,showModel:P,hideModel:N})(oe)),re=a(262);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var le=a(33),ce={display:"none",content:""};var he=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ce,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_ALERT":case"HIDE_ALERT":return t.alert;default:return e}},me={show:!1,content:""};var de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_MODEL":case"HIDE_MODEL":return t.content;default:return e}},ue=Object(le.b)({alert:he,model:de});var pe=function(){return Object(le.c)(ue,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())}();i.a.render(s.a.createElement(M.a,{store:pe},s.a.createElement(re.a,null,s.a.createElement(ie,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[122,2,1]]]);
//# sourceMappingURL=main.ad6a2d50.chunk.js.map